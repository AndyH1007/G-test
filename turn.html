<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æˆ‘çš„è—å»Šï½œå±•è¦½å›åˆ</title>
</head>
<body>
<h1>å±•è¦½å›åˆé ï¼ˆæ•´åˆç‰ˆæœ¬ï¼‰</h1>
<p>æ­¤é åŒ…å«è—è¡“å®¶é¸æ“‡ã€ä½œå“é…ç½®ã€å±•å‰ä»»å‹™ã€çªç™¼äº‹ä»¶èˆ‡è²©å”®äº’å‹•ã€‚</p>
<script>
let state = JSON.parse(localStorage.getItem('my_gallery_state'));
if (!state) { alert("è«‹å…ˆå¾é¦–é é–‹å§‹éŠæˆ²ã€‚"); window.location.href = 'index.html'; }

document.write('<h2>ğŸ¨ ç•¶å‰å›åˆï¼šç¬¬ ' + state.month + ' æœˆ</h2>');
document.write('<p>è³‡é‡‘ï¼š' + state.money + ' é‡‘å¹£ï½œè²æœ›ï¼š' + state.reputation + '</p>');

const artistOptions = [
  { name: "æ–°é€²è—è¡“å®¶", material: "è£ç½®", concept: "ç•¶ä»£", cost: 5, sellRate: 10 },
  { name: "ä¸­ç­‰è—è¡“å®¶", material: "ç¹ªç•«", concept: "ä¸­ç”Ÿä»£", cost: 20, sellRate: 20 },
  { name: "çŸ¥åè—è¡“å®¶", material: "é›•å¡‘", concept: "ç¶“å…¸", cost: 50, sellRate: 30 }
];
const selected = artistOptions[Math.floor(Math.random() * artistOptions.length)];
state.money -= selected.cost;

document.write('<h3>ä½ é¸æ“‡äº†ï¼š' + selected.name + 'ï¼ˆ' + selected.material + '/' + selected.concept + 'ï¼‰</h3>');
document.write('<p>è²»ç”¨ï¼š' + selected.cost + 'ï½œåŸºç¤è²©å”®ç‡ï¼š' + selected.sellRate + '%</p>');

const size = state.size === "large" ? 9 : state.size === "medium" ? 6 : 3;
document.write('<p>ğŸ¯ ä½ çš„ç•«å»Šç©ºé–“æ ¼æ•¸ï¼š' + size + '</p>');
document.write('<p>ç¾åœ¨é…ç½®ä½œå“ï¼ˆå°1æ ¼ï¼ä¸­2æ ¼ï¼å¤§3æ ¼ï¼‰</p>');

document.write('<input id="small" type="number" placeholder="å°å‹æ•¸é‡" value="0" />');
document.write('<input id="medium" type="number" placeholder="ä¸­å‹æ•¸é‡" value="0" />');
document.write('<input id="large" type="number" placeholder="å¤§å‹æ•¸é‡" value="0" />');
document.write('<button onclick="configure()">ç¢ºå®šé…ç½®</button>');
document.write('<div id="output"></div>');

function configure() {
  const s = parseInt(document.getElementById("small").value) || 0;
  const m = parseInt(document.getElementById("medium").value) || 0;
  const l = parseInt(document.getElementById("large").value) || 0;
  const total = s * 1 + m * 2 + l * 3;
  const area = document.getElementById("output");
  if (total > size) return area.innerHTML = '<p style="color:red;">è¶…å‡ºæ ¼æ•¸é™åˆ¶ï¼</p>';

  let result = '<h3>ğŸ° é–‹å§‹è²©å”®</h3>';
  let income = 0;
  for (let i = 0; i < s + m + l; i++) {
    const roll = Math.floor(Math.random() * 100) + 1;
    const success = roll <= selected.sellRate;
    const price = success ? (i < s ? 30 : i < s + m ? 80 : 150) : 0;
    income += price;
    result += `ä½œå“ ${i + 1} æ“²å‡º ${roll}ï¼š${success ? 'æˆåŠŸå”®å‡ºï¼æ”¶å…¥ ' + price + ' é‡‘å¹£' : 'æœªå”®å‡º'}<br>`;
  }

  state.money += income;
  state.reputation += 1;
  state.history.push({ month: state.month, money: state.money, reputation: state.reputation });
  state.month++;
  localStorage.setItem("my_gallery_state", JSON.stringify(state));

  if (state.month > 12) {
    result += '<p><strong>ğŸ‰ éŠæˆ²çµæŸï¼Œå³å°‡å‰å¾€çµç®—é é¢...</strong></p>';
    setTimeout(() => window.location.href = "summary.html", 3000);
  } else {
    result += '<p><strong>âœ… æœ¬å›åˆå®Œæˆï¼Œåˆ·æ–°é€²å…¥ä¸‹ä¸€å›åˆã€‚</strong></p>';
    setTimeout(() => location.reload(), 3000);
  }

  area.innerHTML = result;
}
</script>
</body>
</html>
